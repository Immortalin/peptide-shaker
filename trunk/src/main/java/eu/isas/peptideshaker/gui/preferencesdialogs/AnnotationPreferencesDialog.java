/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * AnnotationPreferencesDialog.java
 *
 * Created on Feb 24, 2011, 5:44:50 PM
 */

package eu.isas.peptideshaker.gui.preferencesdialogs;

import com.compomics.util.experiment.biology.ions.PeptideFragmentIon;
import eu.isas.peptideshaker.gui.PeptideShakerGUI;
import eu.isas.peptideshaker.preferences.AnnotationPreferences;
import javax.swing.JOptionPane;

/**
 *
 * @author vaudel
 */
public class AnnotationPreferencesDialog extends javax.swing.JDialog {

    private AnnotationPreferences annotationPreferences;
    private PeptideShakerGUI peptideShakerGUI;

    /** Creates new form AnnotationPreferencesDialog */
    public AnnotationPreferencesDialog(PeptideShakerGUI peptideShakerGUI, boolean modal, AnnotationPreferences annotationPreferences) {
        super(peptideShakerGUI, modal);
        this.peptideShakerGUI = peptideShakerGUI;
        this.annotationPreferences = annotationPreferences;
        initComponents();
        refreshSelection();
        setVisible(true);
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        aButton = new javax.swing.JRadioButton();
        anh3Button = new javax.swing.JRadioButton();
        ah2oButton = new javax.swing.JRadioButton();
        bButton = new javax.swing.JRadioButton();
        bnh3Button = new javax.swing.JRadioButton();
        bh2oButton = new javax.swing.JRadioButton();
        cButton = new javax.swing.JRadioButton();
        xButton = new javax.swing.JRadioButton();
        yButton = new javax.swing.JRadioButton();
        ynh3Button = new javax.swing.JRadioButton();
        yh2oButton = new javax.swing.JRadioButton();
        zButton = new javax.swing.JRadioButton();
        mhButton = new javax.swing.JRadioButton();
        mhnh3Button = new javax.swing.JRadioButton();
        mhh2oButton = new javax.swing.JRadioButton();
        jLabel1 = new javax.swing.JLabel();
        cancelButton = new javax.swing.JButton();
        okButton = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        mostIntenseButton = new javax.swing.JRadioButton();
        mzToleranceTxt = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        aButton.setText("a");
        aButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                aButtonActionPerformed(evt);
            }
        });

        anh3Button.setText("a-NH3");
        anh3Button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                anh3ButtonActionPerformed(evt);
            }
        });

        ah2oButton.setText("a-H2O");
        ah2oButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ah2oButtonActionPerformed(evt);
            }
        });

        bButton.setText("b");
        bButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bButtonActionPerformed(evt);
            }
        });

        bnh3Button.setText("b-NH3");
        bnh3Button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bnh3ButtonActionPerformed(evt);
            }
        });

        bh2oButton.setText("b-H2O");
        bh2oButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bh2oButtonActionPerformed(evt);
            }
        });

        cButton.setText("c");
        cButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cButtonActionPerformed(evt);
            }
        });

        xButton.setText("x");
        xButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                xButtonActionPerformed(evt);
            }
        });

        yButton.setText("y");
        yButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                yButtonActionPerformed(evt);
            }
        });

        ynh3Button.setText("y-NH3");
        ynh3Button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ynh3ButtonActionPerformed(evt);
            }
        });

        yh2oButton.setText("y-H2O");
        yh2oButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                yh2oButtonActionPerformed(evt);
            }
        });

        zButton.setText("z");
        zButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                zButtonActionPerformed(evt);
            }
        });

        mhButton.setText("MH");
        mhButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mhButtonActionPerformed(evt);
            }
        });

        mhnh3Button.setText("MH-NH3");
        mhnh3Button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mhnh3ButtonActionPerformed(evt);
            }
        });

        mhh2oButton.setText("MH-H2O");
        mhh2oButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mhh2oButtonActionPerformed(evt);
            }
        });

        jLabel1.setText("Please select the ions to look for in spectra:");

        cancelButton.setText("Cancel");
        cancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelButtonActionPerformed(evt);
            }
        });

        okButton.setText("OK");
        okButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                okButtonActionPerformed(evt);
            }
        });

        jLabel2.setText("m/z tolerance:");

        mostIntenseButton.setText("Annotate most intense peaks");
        mostIntenseButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mostIntenseButtonActionPerformed(evt);
            }
        });

        mzToleranceTxt.setText("0.5");

        jLabel3.setText("Da");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(aButton)
                            .addComponent(anh3Button)
                            .addComponent(ah2oButton)
                            .addComponent(bButton)
                            .addComponent(bnh3Button))
                        .addGap(85, 85, 85)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(xButton)
                                    .addComponent(ynh3Button)
                                    .addComponent(yButton))
                                .addGap(83, 83, 83)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(mhButton)
                                    .addComponent(mhnh3Button)
                                    .addComponent(mhh2oButton)))
                            .addComponent(zButton)
                            .addComponent(yh2oButton)))
                    .addComponent(bh2oButton)
                    .addComponent(cButton)
                    .addComponent(jLabel1))
                .addContainerGap(10, Short.MAX_VALUE))
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(mostIntenseButton)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(mzToleranceTxt)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel3)
                .addContainerGap(173, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(237, Short.MAX_VALUE)
                .addComponent(okButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cancelButton)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(mhButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(mhnh3Button)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(mhh2oButton))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(aButton)
                            .addComponent(xButton))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(anh3Button)
                            .addComponent(yButton))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(ah2oButton)
                            .addComponent(ynh3Button))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(bButton)
                            .addComponent(yh2oButton))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(bnh3Button)
                            .addComponent(zButton))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(bh2oButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cButton)))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(mzToleranceTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(mostIntenseButton)
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cancelButton)
                    .addComponent(okButton))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void aButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_aButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.A_ION, aButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_aButtonActionPerformed

    private void bh2oButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bh2oButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.BH2O_ION, bh2oButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_bh2oButtonActionPerformed

    private void ynh3ButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ynh3ButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.YNH3_ION, ynh3Button.isSelected());
        refreshSelection();
    }//GEN-LAST:event_ynh3ButtonActionPerformed

    private void anh3ButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_anh3ButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.ANH3_ION, anh3Button.isSelected());
        refreshSelection();
    }//GEN-LAST:event_anh3ButtonActionPerformed

    private void ah2oButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ah2oButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.AH2O_ION, ah2oButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_ah2oButtonActionPerformed

    private void bButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.B_ION, bButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_bButtonActionPerformed

    private void bnh3ButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bnh3ButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.BNH3_ION, bnh3Button.isSelected());
        refreshSelection();
    }//GEN-LAST:event_bnh3ButtonActionPerformed

    private void cButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.C_ION, cButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_cButtonActionPerformed

    private void xButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_xButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.X_ION, xButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_xButtonActionPerformed

    private void yButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_yButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.Y_ION, yButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_yButtonActionPerformed

    private void yh2oButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_yh2oButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.YH2O_ION, yh2oButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_yh2oButtonActionPerformed

    private void zButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_zButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.Z_ION, zButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_zButtonActionPerformed

    private void mhButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mhButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.MH_ION, mhButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_mhButtonActionPerformed

    private void mhnh3ButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mhnh3ButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.MHNH3_ION, mhnh3Button.isSelected());
        refreshSelection();
    }//GEN-LAST:event_mhnh3ButtonActionPerformed

    private void mhh2oButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mhh2oButtonActionPerformed
        annotationPreferences.setSelected(PeptideFragmentIon.MHH2O_ION, mhh2oButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_mhh2oButtonActionPerformed

    private void okButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_okButtonActionPerformed
        if (validateInput()) {
            annotationPreferences.setTolerance(new Double(mzToleranceTxt.getText().trim()));
        peptideShakerGUI.updateAnnotationPreferences(annotationPreferences);
        dispose();
        }
    }//GEN-LAST:event_okButtonActionPerformed

    private void cancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelButtonActionPerformed
        dispose();
    }//GEN-LAST:event_cancelButtonActionPerformed

    private void mostIntenseButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mostIntenseButtonActionPerformed
        annotationPreferences.annotateMostIntensePeaks(mostIntenseButton.isSelected());
        refreshSelection();
    }//GEN-LAST:event_mostIntenseButtonActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JRadioButton aButton;
    private javax.swing.JRadioButton ah2oButton;
    private javax.swing.JRadioButton anh3Button;
    private javax.swing.JRadioButton bButton;
    private javax.swing.JRadioButton bh2oButton;
    private javax.swing.JRadioButton bnh3Button;
    private javax.swing.JRadioButton cButton;
    private javax.swing.JButton cancelButton;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JRadioButton mhButton;
    private javax.swing.JRadioButton mhh2oButton;
    private javax.swing.JRadioButton mhnh3Button;
    private javax.swing.JRadioButton mostIntenseButton;
    private javax.swing.JTextField mzToleranceTxt;
    private javax.swing.JButton okButton;
    private javax.swing.JRadioButton xButton;
    private javax.swing.JRadioButton yButton;
    private javax.swing.JRadioButton yh2oButton;
    private javax.swing.JRadioButton ynh3Button;
    private javax.swing.JRadioButton zButton;
    // End of variables declaration//GEN-END:variables

    private void refreshSelection() {
            aButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.A_ION));
            anh3Button.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.ANH3_ION));
            ah2oButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.AH2O_ION));
            bButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.B_ION));
            bnh3Button.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.BNH3_ION));
            bh2oButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.BH2O_ION));
            cButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.C_ION));
            xButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.X_ION));
            yButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.Y_ION));
            ynh3Button.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.YNH3_ION));
            yh2oButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.YH2O_ION));
            zButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.Z_ION));
            mhButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.MH_ION));
            mhnh3Button.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.MHNH3_ION));
            mhh2oButton.setSelected(annotationPreferences.isSelected(PeptideFragmentIon.MHH2O_ION));
            mostIntenseButton.setSelected(annotationPreferences.shallAnnotateMostIntensePeaks());
    }

    private boolean validateInput() {
        try {
            new Double(mzToleranceTxt.getText().trim());
            return true;
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Please verify the input for max mass deviation.",
                    "Input Error", JOptionPane.ERROR_MESSAGE);
            return false;
        }
    }



}
